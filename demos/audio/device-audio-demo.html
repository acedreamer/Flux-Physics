<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FLUX Device Audio Reactive Demo</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
            color: white;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            overflow: hidden;
        }
        
        #flux-container {
            width: 100vw;
            height: 100vh;
        }
        
        .demo-info {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #00FFFF;
            max-width: 300px;
        }
        
        .demo-info h2 {
            margin: 0 0 15px 0;
            color: #00FFFF;
            font-size: 18px;
        }
        
        .demo-info p {
            margin: 0 0 10px 0;
            font-size: 14px;
            line-height: 1.4;
        }
        
        .demo-info .instructions {
            background: rgba(0, 255, 255, 0.1);
            padding: 10px;
            border-radius: 4px;
            margin-top: 15px;
        }
        
        .demo-info .instructions h3 {
            margin: 0 0 8px 0;
            color: #00FFFF;
            font-size: 14px;
        }
        
        .demo-info .instructions ol {
            margin: 0;
            padding-left: 20px;
            font-size: 12px;
        }
        
        .demo-info .instructions li {
            margin-bottom: 4px;
        }
        
        .browser-support {
            margin-top: 15px;
            padding: 10px;
            background: rgba(255, 255, 0, 0.1);
            border-radius: 4px;
            border: 1px solid rgba(255, 255, 0, 0.3);
        }
        
        .browser-support h3 {
            margin: 0 0 8px 0;
            color: #FFFF00;
            font-size: 14px;
        }
        
        .browser-support ul {
            margin: 0;
            padding-left: 20px;
            font-size: 12px;
        }
        
        .browser-support li {
            margin-bottom: 4px;
        }
        
        .browser-support .supported {
            color: #00FF00;
        }
        
        .browser-support .limited {
            color: #FFAA00;
        }
        
        .browser-support .unsupported {
            color: #FF4444;
        }
    </style>
</head>
<body>
    <div id="flux-container"></div>
    
    <div class="demo-info">
        <h2>üéµ Device Audio Reactive</h2>
        <p>This demo makes FLUX particles react to any audio playing on your device - music, videos, games, etc.</p>
        
        <div class="instructions">
            <h3>Quick Start:</h3>
            <ol>
                <li>Click "Enable Device Audio" button (top right)</li>
                <li>Choose "Share system audio" in the dialog</li>
                <li>Select your screen to capture</li>
                <li>Play music or videos on your device</li>
                <li>Watch particles react to the audio! üéâ</li>
            </ol>
        </div>
        
        <div class="browser-support">
            <h3>Browser Support:</h3>
            <ul>
                <li class="supported">‚úÖ Chrome - Full system audio</li>
                <li class="supported">‚úÖ Edge - Full system audio</li>
                <li class="limited">‚ö†Ô∏è Firefox - Microphone only</li>
                <li class="limited">‚ö†Ô∏è Safari - Microphone only</li>
            </ul>
        </div>
    </div>

    <script type="module">
        import { FluxApplication } from './src/main.js'
        import { enableDeviceAudioReactive } from './src/audio/examples/device-audio-setup.js'
        
        async function initDemo() {
            try {
                console.log('üöÄ Initializing FLUX Device Audio Demo...')
                
                // Initialize FLUX application
                const container = document.getElementById('flux-container')
                const fluxApp = new FluxApplication(container)
                
                // Wait for FLUX to initialize
                await new Promise(resolve => {
                    const checkInit = () => {
                        if (fluxApp.solver && fluxApp.particleRenderer) {
                            resolve()
                        } else {
                            setTimeout(checkInit, 100)
                        }
                    }
                    checkInit()
                })
                
                console.log('‚úÖ FLUX initialized')
                
                // Enable device audio reactive mode
                const deviceAudio = await enableDeviceAudioReactive(fluxApp, container)
                
                console.log('‚úÖ Device audio setup complete')
                console.log('üëÜ Click the "Enable Device Audio" button to start!')
                
                // Add some helpful logging
                window.fluxApp = fluxApp
                window.deviceAudio = deviceAudio
                
                // Optional: Auto-enable for testing (remove in production)
                // setTimeout(() => {
                //     console.log('üîÑ Auto-enabling device audio for demo...')
                //     deviceAudio.enableDeviceAudio()
                // }, 2000)
                
            } catch (error) {
                console.error('‚ùå Demo initialization failed:', error)
                alert(`Demo failed to initialize: ${error.message}`)
            }
        }
        
        // Start the demo
        initDemo()
        
        // Add some helpful console commands
        console.log(`
üéµ FLUX Device Audio Reactive Demo
================================

Available commands:
‚Ä¢ deviceAudio.enableDeviceAudio() - Enable device audio
‚Ä¢ deviceAudio.disableDeviceAudio() - Disable device audio  
‚Ä¢ deviceAudio.getStatus() - Get current status
‚Ä¢ deviceAudio.switchAudioSource('system') - Switch to system audio
‚Ä¢ deviceAudio.switchAudioSource('microphone') - Switch to microphone

Tips:
‚Ä¢ Play music, videos, or any audio on your device
‚Ä¢ The particles will react to bass, mids, and treble frequencies
‚Ä¢ Beats will create pulse effects and stronger reactions
‚Ä¢ Try different types of music for different effects!
        `)
    </script>
</body>
</html>